<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Crypto Signals</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body {
  font-family: Arial;
  background: #0f172a;
  color: white;
  text-align: center;
  padding: 20px;
}

h2 {
  margin-bottom: 20px;
}

button {
  background: linear-gradient(45deg,#22c55e,#4ade80);
  border: none;
  padding: 15px;
  margin: 10px;
  border-radius: 12px;
  color: white;
  font-size: 16px;
  width: 90%;
}

select {
  padding: 12px;
  border-radius: 10px;
  margin: 10px;
  width: 90%;
  border: none;
}

.card {
  background: #1e293b;
  padding: 20px;
  border-radius: 15px;
  margin-top: 20px;
}
</style>
</head>

<body>

<h2>üöÄ Crypto Signals</h2>

<select id="pair">
  <option value="BTC/USDT">BTC/USDT</option>
  <option value="ETH/USDT">ETH/USDT</option>
  <option value="SOL/USDT">SOL/USDT</option>
</select>

<select id="timeframe">
  <option value="1m">1 –º–∏–Ω—É—Ç–∞</option>
  <option value="5m">5 –º–∏–Ω—É—Ç</option>
  <option value="15m">15 –º–∏–Ω—É—Ç</option>
  <option value="1h">1 —á–∞—Å</option>
</select>

<button onclick="register()">üë§ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</button>
<button onclick="getSignal()">üìà –ü–æ–ª—É—á–∏—Ç—å —Å–∏–≥–Ω–∞–ª</button>

<div id="result" class="card"></div>

<script>
const tg = window.Telegram.WebApp;
const userId = tg.initDataUnsafe.user.id;

function register() {
  fetch('/register', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({ telegramId: userId })
  })
  .then(res => res.json())
  .then(() => {
    document.getElementById('result').innerHTML =
      "‚úÖ –í—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã!";
  });
}

function getSignal() {

  const pair = document.getElementById('pair').value;
  const timeframe = document.getElementById('timeframe').value;

  fetch('/signal', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({
      telegramId: userId,
      pair,
      timeframe
    })
  })
  .then(res => res.json())
  .then(data => {

    if (!data.access) {
      document.getElementById('result').innerHTML =
        "‚ùå –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ";
      return;
    }

    document.getElementById('result').innerHTML =
      `üìä –ü–∞—Ä–∞: ${data.pair}<br>
       ‚è± –¢–∞–π–º—Ñ—Ä–µ–π–º: ${data.timeframe}<br>
       üìà –°–∏–≥–Ω–∞–ª: ${data.signal}`;
  });
}
</script>

</body>
</html>
